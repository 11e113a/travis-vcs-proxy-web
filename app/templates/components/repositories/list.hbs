<div class='top-bar'>
  <div class='setup-input'>
    <h3>Find a repository</h3>
    <div class='entry-field'>
      <Input
        @id='repoSearch'
        @value={{this.repoSearch}}
        @type='text'
        class='text-field'
        {{ on 'keyup' this.filter }}
      />
    </div>
  </div>
  {{#if (eq this.server.type 'svn')}}
  <LinkTo @class="button--green add-repository-button" @model={{this.server.id}} @route="server.add-repository">
    Add Repository
  </LinkTo>
  {{/if}}
  <nav
    class="option-button {{if this.isSortMenuOpen 'is-open'}}"
    {{on 'click' (fn (mut this.isSortMenuOpen) true)}}
    {{on 'mouseleave' (fn (mut this.isSortMenuOpen) false)}}
  >
    <button class="option-display" type="button" title="Show more options">
      <span class="label-align">
        SORT BY
        <SvgImage @name="icon-dropdown-arrow" @class="icon" />
      </span>
    </button>
    <ul class="option-dropdown">
      <li>
        <button
          type="button"
          onclick={{action this.changeSort 'name'}}
        >
          Name
        </button>
      </li>
      <li>
        <button
          type="button"
          onclick={{action this.changeSort 'last_synced_at'}}
        >
          User access
        </button>
      </li>
      <li>
        <button
          type="button"
          onclick={{action this.changeSort 'last_synced_at'}}
        >
          Last updated
        </button>
      </li>
    </ul>
  </nav>
</div>
{{#unless this.repositories.isLoading}}
<div class='repositories-list'>
<table>
  <tr>
    <th>Repository name</th>
    <th>User access</th>
    <th>Last updated</th>
    <th>Update token</th>
    <th>Delete token</th>
  </tr>
  {{#each this.repositories as |repository|}}
  <tr>
    <td class='table-text'>{{repository.name}}</td>
    <td class='table-text capitalize-text'>{{repository.permission}}</td>
    <td class='table-text'>{{pretty-date repository.lastSyncedAt}}</td>
    <td>
      <LinkTo
        @route="repository.update-token"
        @model={{repository.id}}
        @title="Update repository access token"
        @disabled={{not repository.canModify}}
      >
        <EmberTooltip @text="Update repository access token" />
        <SvgImage @name="icon-edit" @class="icon" />
      </LinkTo>
    </td>
    <td>
      <LinkTo
        @route="repository.remove-token"
        @model={{repository.id}}
        @title="Remove repository token"
        @disabled={{not repository.canModify}}
      >
        <EmberTooltip @text="Remove repository token" />
        <SvgImage @name="icon-delete" @class="icon" />
      </LinkTo>
    </td>
  </tr>
  {{/each}}
</table>
</div>
<PaginationNavigation
  @collection={{this.repositories}}
  @route="server.repositories"
  @queryParam="page"
  @inner={{3}}
  @outer={{1}}
/>
{{else}}
<LoadingIndicator />
{{/unless}}